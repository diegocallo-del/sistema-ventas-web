services:
  # Spring Boot Backend Service
  - type: web
    name: sistema-ventas-backend
    env: docker
    plan: free
    buildCommand: "docker build -t sistema-ventas-backend ."
    dockerfilePath: ./backend/Dockerfile
    dockerContext: ./backend
    envVars:
      - key: SPRING_PROFILES_ACTIVE
        value: prod
      - key: DATABASE_URL
        fromSecret: database-url
      - key: DB_USERNAME
        fromSecret: database-username
      - key: DB_PASSWORD
        fromSecret: database-password
      - key: JWT_SECRET
        fromSecret: jwt-secret
      - key: JWT_EXPIRATION
        value: 86400000
      - key: CORS_ALLOWED_ORIGINS
        value: https://sistema-ventas-web.vercel.app,https://www.sistema-ventas-web.vercel.app
      - key: GROQ_API_KEY
        fromSecret: groq-api-key

secrets:
  # Database secrets (configurar en Render dashboard)
  - key: database-url
    value: ${PLANETSCALE_DATABASE_URL}
  - key: database-username
    value: ${PLANETSCALE_USERNAME}
  - key: database-password
    value: ${PLANETSCALE_PASSWORD}

  # JWT secret (generar una nueva para producción)
  - key: jwt-secret
    value: ${JWT_SECRET_PRODUCTION}

  # Groq API Key (para análisis IA)
  - key: groq-api-key
    value: ${GROQ_API_KEY}

# Environment variables documentation:
# 1. Configurar PlanetScale database primero
# 2. Generar JWT secret seguro (mínimo 256 caracteres)
# 3. Obtener API key de Groq (https://console.groq.com/)
# 4. Configurar secrets en Render dashboard antes del deployment
